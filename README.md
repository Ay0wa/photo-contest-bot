# VK Photo Contest Bot üéÆüì∏

–ë–æ—Ç –¥–ª—è –í–ö–æ–Ω—Ç–∞–∫—Ç–µ –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —Ñ–æ—Ç–æ–∫–æ–Ω–∫—É—Ä—Å–æ–≤ –≤ –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–∞—Ö. –£—á–∞—Å—Ç–Ω–∏–∫–∏ —Å–æ—Ä–µ–≤–Ω—É—é—Ç—Å—è, –≥–æ–ª–æ—Å—É—è –∑–∞ –∞–≤–∞—Ç–∞—Ä–∫–∏ –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –≤ —Ç—É—Ä–Ω–∏—Ä–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ.

## üéØ –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

VK Photo Contest Bot ‚Äî —ç—Ç–æ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –±–æ—Ç –¥–ª—è –í–ö–æ–Ω—Ç–∞–∫—Ç–µ, –∫–æ—Ç–æ—Ä—ã–π –æ—Ä–≥–∞–Ω–∏–∑—É–µ—Ç —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–æ—Ç–æ–∫–æ–Ω–∫—É—Ä—Å—ã –≤ –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–∞—Ö. –ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–≤–∞—Ç–∞—Ä–∫–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —á–∞—Ç–∞ –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —Ç—É—Ä–Ω–∏—Ä–∞ –Ω–∞ –≤—ã–±—ã–≤–∞–Ω–∏–µ, –≥–¥–µ –∫–∞–∂–¥—ã–π —Ä–∞—É–Ω–¥ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –≥–æ–ª–æ—Å—É—é—Ç –∑–∞ –ª—É—á—à—É—é —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é.

### ‚ú® –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üéÆ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∏–≥—Ä** ‚Äî –±–æ—Ç —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º
- üë• **–ú–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ç—É—Ä–Ω–∏—Ä—ã** ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ—Ç 3 —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- üó≥Ô∏è **–°–∏—Å—Ç–µ–º–∞ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è** ‚Äî —É—á–∞—Å—Ç–Ω–∏–∫–∏ –≥–æ–ª–æ—Å—É—é—Ç –∑–∞ –ª—É—á—à–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
- üìä **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏** ‚Äî –∏—Å—Ç–æ—Ä–∏—è –∏–≥—Ä –∏ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π
- üéØ **–°–æ—Å—Ç–æ—è–Ω–∏—è —á–∞—Ç–∞** ‚Äî —É–º–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–≤—ã–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º
- üì± **–ò–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** ‚Äî —É–¥–æ–±–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –∏ –∫–æ–º–∞–Ω–¥—ã

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º Python-—Å—Ç–µ–∫–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º:

- **Backend**: aiohttp + SQLAlchemy (async)
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL
- **–ú–∏–≥—Ä–∞—Ü–∏–∏**: Alembic
- **API**: VK API 5.131
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è**: Docker + Docker Compose
- **–õ–∏–Ω—Ç–∏–Ω–≥**: Ruff

### üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
app/
‚îú‚îÄ‚îÄ admin/          # –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å
‚îú‚îÄ‚îÄ bot/            # –õ–æ–≥–∏–∫–∞ –±–æ—Ç–∞ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ states/     # –ú–∞—à–∏–Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ manager.py  # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
‚îú‚îÄ‚îÄ chats/          # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–∞—Ç–∞–º–∏
‚îú‚îÄ‚îÄ games/          # –õ–æ–≥–∏–∫–∞ –∏–≥—Ä
‚îú‚îÄ‚îÄ players/        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞–º–∏
‚îú‚îÄ‚îÄ vk_api/         # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å VK API
‚îú‚îÄ‚îÄ web/            # –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îî‚îÄ‚îÄ database/       # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.11+
- Docker –∏ Docker Compose
- VK –≥—Ä—É–ø–ø–∞ —Å —Ç–æ–∫–µ–Ω–æ–º

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone <your-repository-url>
cd photo-contest-bot
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example`:

```bash
cp .env.example .env
```

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```env
# VK API
VK_TOKEN=your_vk_api_token_here
GROUP_ID=your_vk_group_id

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
DB_HOST=localhost
DB_PORT=5432
DB_USER=your_db_username
DB_PASSWORD=your_db_password
DB_NAME=your_db_name

# –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
DEBUG=True
SECRET_KEY=your_secret_key

# –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
EMAIL=your_admin_email
ADMIN_PASSWORD=your_admin_password
```

### 3. –ó–∞–ø—É—Å–∫ —Å Docker

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker compose up --build

# –ò–ª–∏ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
docker compose up -d --build
```

### 4. –ó–∞–ø—É—Å–∫ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python -m venv venv
source venv/bin/activate  # Linux/MacOS
# –∏–ª–∏
venv\Scripts\activate     # Windows

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# –ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–π
alembic upgrade head

# –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
python main.py
```

## üéÆ –ö–∞–∫ –∏–≥—Ä–∞—Ç—å

### –ù–∞—á–∞–ª–æ –∏–≥—Ä—ã

1. –î–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç –í–ö–æ–Ω—Ç–∞–∫—Ç–µ
2. –ù–∞–∑–Ω–∞—á—å—Ç–µ –±–æ—Ç–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º —á–∞—Ç–∞
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `/keyboard` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
4. –ù–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å –∏–≥—Ä—É"

### –ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã

1. **–ú–∏–Ω–∏–º—É–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤**: 3 —á–µ–ª–æ–≤–µ–∫–∞
2. **–†–∞—É–Ω–¥—ã**: –í –∫–∞–∂–¥–æ–º —Ä–∞—É–Ω–¥–µ —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è 2 –∞–≤–∞—Ç–∞—Ä–∫–∏
3. **–ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ**: –£—á–∞—Å—Ç–Ω–∏–∫–∏ –≥–æ–ª–æ—Å—É—é—Ç –∑–∞ –ø–æ–Ω—Ä–∞–≤–∏–≤—à—É—é—Å—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é
4. **–ò—Å–∫–ª—é—á–µ–Ω–∏–µ**: –ê–≤—Ç–æ—Ä—ã —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –Ω–µ –≥–æ–ª–æ—Å—É—é—Ç –≤ —Å–≤–æ–µ–º —Ä–∞—É–Ω–¥–µ
5. **–ü–æ–±–µ–¥–∏—Ç–µ–ª—å**: –ü–æ—Å–ª–µ–¥–Ω–∏–π –æ—Å—Ç–∞–≤—à–∏–π—Å—è —É—á–∞—Å—Ç–Ω–∏–∫

### –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/help` ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥
- `/rules` ‚Äî –ø—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã
- `/keyboard` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

## üîß API Documentation

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É:
- Swagger UI: `http://localhost:8000/docs`
- OpenAPI JSON: `http://localhost:8000/docs/json`

### –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

- `POST /admin.login` ‚Äî –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- `GET /admin.current` ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–µ
- `GET /chats.list_chats` ‚Äî —Å–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤
- `GET /games.list_games` ‚Äî —Å–ø–∏—Å–æ–∫ –∏–≥—Ä —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
- `GET /players.list_players` ‚Äî —Å–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

- **ChatModel** ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —á–∞—Ç–∞—Ö –∏ –∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö
- **GameModel** ‚Äî –∏–≥—Ä—ã –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å—ã
- **PlayerModel** ‚Äî –∏–≥—Ä–æ–∫–∏ –∏ –∏—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- **AdminModel** ‚Äî –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã —Å–∏—Å—Ç–µ–º—ã

### –ú–∏–≥—Ä–∞—Ü–∏–∏

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏
alembic revision --autogenerate -m "–æ–ø–∏—Å–∞–Ω–∏–µ_–∏–∑–º–µ–Ω–µ–Ω–∏–π"

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
alembic upgrade head

# –û—Ç–∫–∞—Ç –º–∏–≥—Ä–∞—Ü–∏–∏
alembic downgrade -1
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
pytest

# –ó–∞–ø—É—Å–∫ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pytest --cov=app

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
pytest tests/chat/test_accessors/test_chat.py
```

## üìù –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞

```bash
# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
ruff format

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
ruff check --fix

# –¢–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–∫–∞
ruff check --no-fix
```

## üöÄ –î–µ–ø–ª–æ–π

### GitHub Actions

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç CI/CD pipeline:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ —Å Ruff
- –°–±–æ—Ä–∫–∞ –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏—è Docker –æ–±—Ä–∞–∑–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –ø—Ä–∏ push –≤ main

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –¥–µ–ø–ª–æ—è

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤ GitHub Secrets:
- `DOCKER_USERNAME`
- `DOCKERHUB_TOKEN`
